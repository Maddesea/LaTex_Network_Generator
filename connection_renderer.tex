% connection_renderer.tex - Network connection rendering and visualization
% This module handles all connection types, paths, and flow visualization

% ============================================================================
% CONNECTION DATA STRUCTURES
% ============================================================================

% Connection counter
\newcounter{conncount}

% TODO: Connection management
% - Hash map for connection lookup
% - Bidirectional connection deduplication
% - Connection grouping by protocol/type
% - Connection state tracking (active/inactive)

% ============================================================================
% BASIC CONNECTION COMMANDS
% ============================================================================

% Draw a normal connection
% Usage: \drawConnection{from}{to}{label}
\newcommand{\drawConnection}[3]{
    \draw[normal conn] (#1) -- node[above, font=\tiny] {#3} (#2);
}

% Draw an encrypted connection
% Usage: \drawEncryptedConnection{from}{to}{protocol}
\newcommand{\drawEncryptedConnection}[3]{
    \draw[encrypted conn] (#1) -- node[above, font=\tiny\ttfamily] {#3} (#2);
}

% Draw a suspicious connection
% Usage: \drawSuspiciousConnection{from}{to}{reason}
\newcommand{\drawSuspiciousConnection}[3]{
    \draw[suspicious conn] (#1) -- node[above, font=\tiny, fill=yellow!30] {#3} (#2);
}

% Draw an attack connection
% Usage: \drawAttackConnection{from}{to}{attack_type}
\newcommand{\drawAttackConnection}[3]{
    \draw[attack conn] (#1) -- node[midway, above, threat label] {#3} (#2);
}

% Bidirectional connection
% Usage: \drawBidirectional{from}{to}{label}
\newcommand{\drawBidirectional}[3]{
    \draw[normal conn, bidirectional] (#1) -- node[above, font=\tiny] {#3} (#2);
}

% ============================================================================
% SPECIALIZED CONNECTION TYPES
% ============================================================================

% VPN tunnel connection
% Usage: \drawVPNTunnel{from}{to}{protocol}
\newcommand{\drawVPNTunnel}[3]{
    \draw[draw=vpnGreen, line width=2pt, dashed,
          dash pattern=on 5pt off 3pt,
          -{Stealth[length=3mm]}]
        (#1) -- node[above, font=\tiny\ttfamily, fill=white] {#3} (#2);
    \draw[draw=vpnGreen!30, line width=4pt,
          dash pattern=on 5pt off 3pt]
        (#1) -- (#2);
}

% Wireless connection (with wave pattern)
% Usage: \drawWirelessConnection{from}{to}{ssid}
\newcommand{\drawWirelessConnection}[3]{
    \draw[draw=iotGreen, line width=1.5pt,
          decoration={snake, amplitude=1.5pt, segment length=8pt},
          decorate,
          -{Stealth[length=3mm]}]
        (#1) -- node[above, font=\tiny, fill=white] {WiFi: #3} (#2);
}

% Fiber optic connection (with light effect)
% Usage: \drawFiberConnection{from}{to}{speed}
\newcommand{\drawFiberConnection}[3]{
    \draw[draw=azureBlue, line width=2pt,
          -{Stealth[length=3mm]}]
        (#1) -- node[above, font=\tiny] {Fiber: #3} (#2);
    \draw[draw=azureBlue!30, line width=4pt]
        (#1) -- (#2);
    % Light effect
    \draw[draw=white, line width=0.5pt, opacity=0.7]
        (#1) -- (#2);
}

% Serial/legacy connection
% Usage: \drawSerialConnection{from}{to}{baudrate}
\newcommand{\drawSerialConnection}[3]{
    \draw[draw=black!60, line width=1pt,
          dash pattern=on 2pt off 1pt,
          -{Stealth[length=2mm]}]
        (#1) -- node[above, font=\tiny\ttfamily] {Serial: #3} (#2);
}

% Satellite link
% Usage: \drawSatelliteLink{from}{to}{latency}
\newcommand{\drawSatelliteLink}[3]{
    \draw[draw=routerOrange, line width=1.5pt,
          -{Stealth[length=3mm]}]
        (#1) to[bend left=45]
        node[above, font=\tiny] {Satellite: #3ms} (#2);
    % Satellite indicator at peak
    \node[star, star points=4, fill=routerOrange, minimum size=0.3cm]
        at ($(#1)!0.5!(#2) + (0,2)$) {};
}

% Cross-connect/direct connection
% Usage: \drawCrossConnect{from}{to}{type}
\newcommand{\drawCrossConnect}[3]{
    \draw[draw=switchPurple, line width=2.5pt,
          double,
          double distance=1pt,
          -{Stealth[length=3mm]}]
        (#1) -- node[above, font=\tiny\bfseries] {#3} (#2);
}

% ============================================================================
% ADVANCED CONNECTION RENDERING
% ============================================================================

% Connection with bandwidth indicator
% Usage: \drawConnectionWithBandwidth{from}{to}{bandwidth}{label}
\newcommand{\drawConnectionWithBandwidth}[4]{
    % Line width based on bandwidth
    \pgfmathsetmacro{\linewidth}{1 + (#3/1000)}
    \draw[draw=connNormal, line width=\linewidth pt, -{Stealth[length=3mm]}] 
        (#1) -- node[above, font=\tiny] {#4: #3 Mbps} (#2);
}

% Connection with protocol and port information
% Usage: \drawConnectionWithPort{from}{to}{protocol}{port}{label}
\newcommand{\drawConnectionWithPort}[5]{
    \draw[normal conn] (#1) --
        node[above, font=\tiny\ttfamily] {#5}
        node[below, port label] {#3:#4}
        (#2);
}

% Enhanced bandwidth visualization with log scale
% Usage: \drawConnectionWithBandwidthLog{from}{to}{bandwidth_mbps}{label}
\newcommand{\drawConnectionWithBandwidthLog}[4]{
    % Log scale mapping: 1 Mbps -> 1pt, 10 Mbps -> 1.5pt, 100 Mbps -> 2pt, 1000 Mbps -> 2.5pt
    \pgfmathsetmacro{\logbw}{1 + 0.5*log10(#3)}
    \pgfmathsetmacro{\bwlinewidth}{max(0.5, min(4, \logbw))}

    \draw[draw=connNormal, line width=\bwlinewidth pt, -{Stealth[length=3mm]}]
        (#1) -- (#2)
        node[midway, above, font=\tiny] {#4}
        node[midway, below, font=\tiny\ttfamily, fill=white, inner sep=1pt] {#3 Mbps};
}

% Bandwidth with utilization percentage and color coding
% Usage: \drawConnectionWithUtilization{from}{to}{current_mbps}{max_mbps}{label}
\newcommand{\drawConnectionWithUtilization}[5]{
    % Calculate utilization percentage
    \pgfmathsetmacro{\utilpercent}{(#3/#4) * 100}

    % Color code by utilization: green < 50%, yellow < 80%, red >= 80%
    \pgfmathsetmacro{\utilizcolor}{ifthenelse(\utilpercent<50,0,ifthenelse(\utilpercent<80,1,2))}

    \ifnum\utilizcolor=0
        \def\bwcolor{clientGreen}
    \else\ifnum\utilizcolor=1
        \def\bwcolor{threatMedium}
    \else
        \def\bwcolor{threatCritical}
    \fi\fi

    % Line width based on current bandwidth
    \pgfmathsetmacro{\utillinewidth}{1 + (#3/1000)}

    \draw[draw=\bwcolor, line width=\utillinewidth pt, -{Stealth[length=3mm]}]
        (#1) -- (#2)
        node[midway, above, font=\tiny] {#4}
        node[midway, below, font=\tiny\ttfamily, fill=white, inner sep=1pt] {
            \pgfmathprintnumber[precision=1]{\utilpercent}\% (#3/#4 Mbps)
        };
}

% Connection with congestion indicator
% Usage: \drawConnectionWithCongestion{from}{to}{congestion_level}{label}
% Congestion levels: none, low, medium, high, critical
\newcommand{\drawConnectionWithCongestion}[4]{
    \ifthenelse{\equal{#3}{none}}{
        \def\congcolor{clientGreen}
        \def\conglabel{Normal}
        \def\congwidth{1pt}
    }{
    \ifthenelse{\equal{#3}{low}}{
        \def\congcolor{threatLow}
        \def\conglabel{Low Congestion}
        \def\congwidth{1.5pt}
    }{
    \ifthenelse{\equal{#3}{medium}}{
        \def\congcolor{threatMedium}
        \def\conglabel{Congestion}
        \def\congwidth{2pt}
    }{
    \ifthenelse{\equal{#3}{high}}{
        \def\congcolor{threatHigh}
        \def\conglabel{High Congestion}
        \def\congwidth{2.5pt}
    }{
        \def\congcolor{threatCritical}
        \def\conglabel{SEVERE}
        \def\congwidth{3pt}
    }}}}

    \draw[draw=\congcolor, line width=\congwidth, -{Stealth[length=3mm]}]
        (#1) -- (#2)
        node[midway, above, font=\tiny] {#4}
        node[midway, below, font=\tiny\bfseries, fill=\congcolor!20, inner sep=2pt] {\conglabel};
}

% Multi-protocol connection with stacked labels
% Usage: \drawMultiProtocolConnection{from}{to}{protocol_list}{label}
% Example: \drawMultiProtocolConnection{srv1}{pc1}{HTTP,HTTPS,SSH}{Web Services}
\newcommand{\drawMultiProtocolConnection}[4]{
    \draw[normal conn, line width=1.5pt] (#1) -- (#2)
        node[midway, above, font=\tiny] {#4}
        node[midway, below, font=\tiny\ttfamily, fill=white, inner sep=2pt, align=center] {#3};
}

% Protocol-specific styled connections
% Usage: \drawHTTPConnection{from}{to}{label}
\newcommand{\drawHTTPConnection}[3]{
    \draw[draw=serverBlue, line width=1pt, -{Stealth[length=3mm]}]
        (#1) -- (#2)
        node[midway, above, font=\tiny] {#3}
        node[midway, below, font=\tiny\ttfamily, fill=serverBlue!20, inner sep=1pt] {HTTP:80};
}

% Usage: \drawHTTPSConnection{from}{to}{label}
\newcommand{\drawHTTPSConnection}[3]{
    \draw[draw=connEncrypted, line width=1.5pt, -{Stealth[length=3mm]}]
        (#1) -- (#2)
        node[midway, above, font=\tiny] {#3}
        node[midway, below, font=\tiny\ttfamily, fill=connEncrypted!20, inner sep=1pt] {HTTPS:443};
}

% Usage: \drawSSHConnection{from}{to}{label}
\newcommand{\drawSSHConnection}[3]{
    \draw[draw=connEncrypted, line width=1.5pt, dashed, -{Stealth[length=3mm]}]
        (#1) -- (#2)
        node[midway, above, font=\tiny] {#3}
        node[midway, below, font=\tiny\ttfamily, fill=connEncrypted!20, inner sep=1pt] {SSH:22};
}

% Usage: \drawDNSConnection{from}{to}{label}
\newcommand{\drawDNSConnection}[3]{
    \draw[draw=dnsBlue, line width=1pt, -{Stealth[length=3mm]}]
        (#1) -- (#2)
        node[midway, above, font=\tiny] {#3}
        node[midway, below, font=\tiny\ttfamily, fill=dnsBlue!20, inner sep=1pt] {DNS:53};
}

% Usage: \drawSQLConnection{from}{to}{label}
\newcommand{\drawSQLConnection}[3]{
    \draw[draw=databaseTeal, line width=1.5pt, -{Stealth[length=3mm]}]
        (#1) -- (#2)
        node[midway, above, font=\tiny] {#3}
        node[midway, below, font=\tiny\ttfamily, fill=databaseTeal!20, inner sep=1pt] {SQL:3306};
}

% Connection with custom port and protocol
% Usage: \drawCustomProtocolConnection{from}{to}{protocol}{port}{color}{label}
\newcommand{\drawCustomProtocolConnection}[6]{
    \draw[draw=#5, line width=1.5pt, -{Stealth[length=3mm]}]
        (#1) -- (#2)
        node[midway, above, font=\tiny] {#6}
        node[midway, below, font=\tiny\ttfamily, fill=#5!20, inner sep=1pt] {#3:#4};
}

% Curved connection (for avoiding overlaps)
% Usage: \drawCurvedConnection{from}{to}{bend}{label}
\newcommand{\drawCurvedConnection}[4]{
    \draw[normal conn] (#1) to[bend left=#3] 
        node[above, font=\tiny] {#4} (#2);
}

% ============================================================================
% ADVANCED CONNECTION ROUTING
% ============================================================================

% Bezier curve connection (smooth curves)
% Usage: \drawBezierConnection{from}{to}{control1_x}{control1_y}{control2_x}{control2_y}{label}
\newcommand{\drawBezierConnection}[7]{
    \draw[normal conn] (#1) .. controls (#3,#4) and (#5,#6) .. (#2)
        node[midway, above, font=\tiny] {#7};
}

% Auto-curved connection (avoids obstacles)
% Usage: \drawSmartConnection{from}{to}{avoid_node}{label}
\newcommand{\drawSmartConnection}[4]{
    % Calculate midpoint offset away from obstacle
    \path (#1) -- (#2) coordinate[midway] (connmid);
    \path (connmid) -- (#3) coordinate[pos=1.5] (offset);

    \draw[normal conn] (#1) .. controls (offset) .. (#2)
        node[midway, above, font=\tiny] {#4};
}

% Orthogonal connection (right angles only)
% Usage: \drawOrthogonalConnection{from}{to}{via_point}{label}
\newcommand{\drawOrthogonalConnection}[4]{
    \draw[normal conn] (#1) |- (#3) -| (#2)
        node[near end, above, font=\tiny] {#4};
}

% Alternative orthogonal routing
% Usage: \drawOrthogonalHV{from}{to}{label}
\newcommand{\drawOrthogonalHV}[3]{
    \draw[normal conn] (#1) -| (#2)
        node[near end, above, font=\tiny] {#3};
}

% Alternative orthogonal routing (vertical first)
% Usage: \drawOrthogonalVH{from}{to}{label}
\newcommand{\drawOrthogonalVH}[3]{
    \draw[normal conn] (#1) |- (#2)
        node[near end, above, font=\tiny] {#3};
}

% Multi-segment path through waypoints
% Usage: \drawPathThroughWaypoints{from}{waypoint_list}{to}{label}
% Example: \drawPathThroughWaypoints{srv1}{(2,3) (4,5) (6,4)}{pc1}{Route}
\newcommand{\drawPathThroughWaypoints}[4]{
    \draw[normal conn] (#1) -- #2 -- (#3)
        node[near end, above, font=\tiny] {#4};
}

% Connection with explicit routing points
% Usage: \drawRoutedConnection{from}{to}{mid_x}{mid_y}{label}
\newcommand{\drawRoutedConnection}[5]{
    \draw[normal conn] (#1) -- (#3,#4) -- (#2)
        node[near end, above, font=\tiny] {#5};
}

% S-curve connection (smooth transition)
% Usage: \drawSCurveConnection{from}{to}{bend_amount}{label}
\newcommand{\drawSCurveConnection}[4]{
    \draw[normal conn] (#1) to[out=0, in=180, distance=#3cm] (#2)
        node[midway, above, font=\tiny] {#4};
}

% Loop connection (node to itself)
% Usage: \drawLoopConnection{node}{angle}{size}{label}
\newcommand{\drawLoopConnection}[4]{
    \draw[normal conn] (#1) to[out=#2, in=#2+60, distance=#3cm] (#1)
        node[midway, above, font=\tiny] {#4};
}

% Connection bundling (show multiple as one thick line)
% Usage: \drawBundledConnection{from}{to}{connection_count}{label}
\newcommand{\drawBundledConnection}[4]{
    % Line thickness increases with connection count
    \pgfmathsetmacro{\bundlewidth}{min(5, 1 + #3/5)}

    \draw[draw=connNormal, line width=\bundlewidth pt, -{Stealth[length=3mm]}]
        (#1) -- (#2)
        node[midway, above, font=\tiny, fill=white, inner sep=2pt] {#4}
        node[midway, below, font=\tiny, fill=white, inner sep=1pt] {#3 connections};
}

% Path finding with Manhattan distance (simple obstacle avoidance)
% Usage: \drawManhattanPath{from}{to}{offset_dir}{label}
% offset_dir: up, down, left, right
\newcommand{\drawManhattanPath}[4]{
    \ifthenelse{\equal{#3}{up}}{
        \draw[normal conn] (#1) |- ++(0,2) -| (#2)
            node[near end, above, font=\tiny] {#4};
    }{
    \ifthenelse{\equal{#3}{down}}{
        \draw[normal conn] (#1) |- ++(0,-2) -| (#2)
            node[near end, above, font=\tiny] {#4};
    }{
    \ifthenelse{\equal{#3}{left}}{
        \draw[normal conn] (#1) -| ++(-2,0) |- (#2)
            node[near end, above, font=\tiny] {#4};
    }{
        \draw[normal conn] (#1) -| ++(2,0) |- (#2)
            node[near end, above, font=\tiny] {#4};
    }}}
}

% ============================================================================
% CONNECTION FLOW VISUALIZATION
% ============================================================================

% Animated flow indicators (requires animation package)
% Usage: \drawFlowConnection{from}{to}{direction}{speed}
\newcommand{\drawFlowConnection}[4]{
    \draw[draw=connNormal, line width=1.5pt, -{Stealth[length=3mm]}] (#1) -- (#2)
        [postaction={
            decorate,
            decoration={
                markings,
                mark=between positions 0.1 and 0.9 step 0.2 with {
                    \ifthenelse{\equal{#3}{forward}}{
                        \arrow{Stealth[length=2mm, fill=connNormal]}
                    }{
                        \arrow{Stealth[reversed, length=2mm, fill=connNormal]}
                    }
                }
            }
        }];
}

% Traffic flow with volume indicator
% Usage: \drawTrafficFlow{from}{to}{packets_per_sec}{label}
\newcommand{\drawTrafficFlow}[4]{
    \pgfmathsetmacro{\density}{min(10, #3/100)}
    \draw[draw=connNormal, line width=1.5pt, -{Stealth[length=3mm]}] 
        (#1) -- node[above, font=\tiny] {#4: #3 pps} (#2)
        [postaction={
            decorate,
            decoration={
                markings,
                mark=between positions 0.1 and 0.9 step {0.1/\density} with {
                    \node[circle, fill=connNormal, inner sep=0.5pt] {};
                }
            }
        }];
}

% TODO: Flow visualization enhancements
% - Real-time traffic animation (if rendering to animated format)
% - Packet visualization with different colors per protocol
% - Congestion indicators (red/yellow traffic markers)
% - Flow direction with multiple arrows
% - Throughput heatmap coloring

% ============================================================================
% CONNECTION RENDERING ENGINE
% ============================================================================

% Main command to render all connections
\newcommand{\renderConnections}{
    % This will be populated by network_data.tex
    % Example structure:
    % \drawConnection{srv1}{pc1}{HTTP}
    % \drawAttackConnection{attacker1}{srv1}{SQL Injection}
}

% TODO: Intelligent connection rendering
% - Layer-based rendering (background to foreground)
% - Z-order management for overlapping connections
% - Automatic connection routing to minimize crossings
% - Connection aggregation (show "10 connections" instead of 10 lines)
% - Highlight selected connection paths

% ============================================================================
% CONNECTION LABELS AND ANNOTATIONS
% ============================================================================

% Add inline statistics to connection
% Usage: \labelConnectionStats{from}{to}{latency}{packet_loss}{jitter}
\newcommand{\labelConnectionStats}[5]{
    \draw[normal conn] (#1) -- (#2)
        node[midway, below, font=\tiny\ttfamily, fill=white, inner sep=2pt] {
            L:#3ms | PL:#4\% | J:#5ms
        };
}

% Add threat score to connection
% Usage: \labelConnectionThreat{from}{to}{score}{details}
\newcommand{\labelConnectionThreat}[4]{
    \draw[suspicious conn] (#1) -- (#2)
        node[midway, threat label] {
            \textbf{#3/10} #4
        };
}

% ============================================================================
% CONNECTION HEALTH AND QUALITY INDICATORS
% ============================================================================

% Draw connection health status
% Usage: \drawConnectionHealth{from}{to}{health}{label}
% Health: good, degraded, poor, down
\newcommand{\drawConnectionHealth}[4]{
    \ifthenelse{\equal{#3}{good}}{
        \def\healthcolor{clientGreen}
        \def\healthwidth{1.5pt}
    }{
    \ifthenelse{\equal{#3}{degraded}}{
        \def\healthcolor{threatMedium}
        \def\healthwidth{2pt}
    }{
    \ifthenelse{\equal{#3}{poor}}{
        \def\healthcolor{threatHigh}
        \def\healthwidth{2.5pt}
    }{
        \def\healthcolor{threatCritical}
        \def\healthwidth{3pt}
    }}}

    \draw[draw=\healthcolor, line width=\healthwidth,
          -{Stealth[length=3mm]}]
        (#1) -- node[above, font=\tiny, fill=white] {#4} (#2);
}

% Connection with QoS indicators
% Usage: \drawConnectionWithQoS{from}{to}{priority}{label}
% Priority: critical, high, normal, low
\newcommand{\drawConnectionWithQoS}[4]{
    \ifthenelse{\equal{#3}{critical}}{
        \def\qoscolor{threatCritical}
        \def\qoslabel{CRITICAL QoS}
    }{
    \ifthenelse{\equal{#3}{high}}{
        \def\qoscolor{routerOrange}
        \def\qoslabel{HIGH QoS}
    }{
    \ifthenelse{\equal{#3}{normal}}{
        \def\qoscolor{serverBlue}
        \def\qoslabel{NORMAL}
    }{
        \def\qoscolor{cloudGray}
        \def\qoslabel{LOW QoS}
    }}}

    \draw[draw=\qoscolor, line width=2pt,
          -{Stealth[length=3mm]}]
        (#1) -- node[above, font=\tiny] {#4} (#2);
    \node[font=\tiny\bfseries, text=\qoscolor, fill=white, inner sep=1pt]
        at ($(#1)!0.5!(#2)$) [below=2pt] {\qoslabel};
}

% Connection with SLA monitoring
% Usage: \drawConnectionWithSLA{from}{to}{uptime}{sla_target}{label}
\newcommand{\drawConnectionWithSLA}[5]{
    \pgfmathsetmacro{\slamet}{ifthenelse(#3>=#4,1,0)}
    \ifnum\slamet=1
        \def\slacolor{clientGreen}
        \def\slastatus{SLA Met}
    \else
        \def\slacolor{threatCritical}
        \def\slastatus{SLA Breach}
    \fi

    \draw[draw=\slacolor, line width=1.5pt,
          -{Stealth[length=3mm]}]
        (#1) -- node[above, font=\tiny] {#5} (#2);
    \node[font=\tiny, fill=\slacolor!20, draw=\slacolor,
          rounded corners=1pt, inner sep=2pt]
        at ($(#1)!0.5!(#2)$) [below=3pt] {#3\% (\slastatus)};
}

% Multi-metric connection label
% Usage: \drawConnectionMetrics{from}{to}{bandwidth}{latency}{loss}{jitter}
\newcommand{\drawConnectionMetrics}[6]{
    \draw[normal conn] (#1) -- (#2);
    \node[font=\tiny\ttfamily, fill=white, draw=black!30,
          rounded corners=2pt, inner sep=3pt, align=left]
        at ($(#1)!0.5!(#2)$) {
        BW: #3 Mbps \\
        Latency: #4 ms \\
        Loss: #5\% \\
        Jitter: #6 ms
    };
}

% ============================================================================
% CONNECTION FILTERING AND LAYERS
% ============================================================================

% Only show connections of specific type
% Usage: \filterConnectionsByType{type}
% Types: all, encrypted, suspicious, attacks, normal
\newcommand{\filterConnectionsByType}[1]{
    % Implementation would use conditional rendering
}

% Show connections only for specific protocol
% Usage: \filterConnectionsByProtocol{protocol}
\newcommand{\filterConnectionsByProtocol}[1]{
    % Implementation would filter by protocol name
}

% TODO: Advanced filtering
% - Port-based filtering (show only port 80, 443, etc.)
% - Time-based filtering (show connections in time range)
% - Threshold filtering (show only high-bandwidth connections)
% - Interactive layer toggles for different connection types
% - Subnet-based filtering (show only intra/inter-subnet)

% ============================================================================
% CONNECTION PATTERNS AND ANALYSIS
% ============================================================================

% Highlight attack pattern (multiple sources to one target)
% Usage: \highlightAttackPattern{target}{sources}
\newcommand{\highlightAttackPattern}[2]{
    \begin{scope}[on background layer]
        \foreach \source in {#2} {
            \draw[attack conn, line width=2pt] (\source) -- (#1);
        }
        % Draw highlight around target
        \node[draw=threatCritical, line width=3pt, 
              rounded corners=5pt, inner sep=8pt, 
              fill=threatCritical!10] at (#1) {};
    \end{scope}
}

% Show connection path through network
% Usage: \showConnectionPath{node_list}
\newcommand{\showConnectionPath}[1]{
    % Draw path through multiple hops
    % Highlight the route taken by traffic
}

% TODO: Pattern detection visualization
% - DDoS pattern (many-to-one)
% - Data exfiltration pattern (one-to-many external)
% - Lateral movement pattern (peer-to-peer internal)
% - Command & Control pattern (periodic beaconing)
% - Port scanning pattern (one-to-many same port)

% ============================================================================
% CONNECTION STATISTICS AND METRICS
% ============================================================================

% Draw connection statistics summary
% Usage: \drawConnectionSummary{x}{y}
\newcommand{\drawConnectionSummary}[2]{
    \node[legend box, anchor=north west] at (#1,#2) {
        \begin{tabular}{lr}
            \textbf{Connections} & \\
            Normal & \theconncount \\
            Encrypted & 0 \\
            Suspicious & 0 \\
            Attacks & 0 \\
        \end{tabular}
    };
}

% TODO: Statistics enhancements
% - Real-time connection counts
% - Bandwidth utilization graphs
% - Protocol distribution pie chart
% - Top talkers list
% - Connection timeline visualization

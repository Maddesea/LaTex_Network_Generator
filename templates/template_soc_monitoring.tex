% TEMPLATE: SOC Monitoring Dashboard
% Real-time security operations monitoring view
%
% QUICK START:
% 1. Copy this template
% 2. Update SIEM and IDS statistics
% 3. Modify incident counts and severities
% 4. Adjust monitoring coverage percentages

\documentclass[tikz,border=10pt]{standalone}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{ifthen}
\usepackage{colortbl}
\usetikzlibrary{positioning,shapes.geometric,arrows.meta,shadows.blur}

\input{styles_config}
\input{node_definitions}
\input{network_layout}
\input{connection_renderer}
\input{threat_indicators}

\begin{document}
\begin{tikzpicture}[scale=0.8, transform shape, font=\sffamily]

% ===== MONITORED INFRASTRUCTURE =====
\createCloud{internet}{0}{8}{Internet}
\createAttacker{threat}{-6}{8}{Active Threat}

\createFirewall{firewall}{0}{5}{Firewall}
\createServer{ids}{4}{5}{IDS/IPS}

\createServer{webserver}{-3}{2}{Web Server}
\createServer{mailserver}{3}{2}{Mail Server}

\createRouter{router}{0}{-1}{Router}
\createServer{fileserver}{-3}{-4}{File Server}
\createClient{workstation}{3}{-4}{Workstation}

% SIEM
\createServer{siem}{-8}{-1}{SIEM Platform}

% ===== CONNECTIONS =====
\drawConnection{internet}{firewall}{Traffic}
\drawConnection{firewall}{webserver}{HTTP/S}
\drawConnection{firewall}{mailserver}{SMTP}
\drawConnection{webserver}{router}{Internal}
\drawConnection{mailserver}{router}{Internal}
\drawConnection{router}{fileserver}{SMB}
\drawConnection{router}{workstation}{User}

% Attack traffic (CUSTOMIZE)
\drawAttackConnection{threat}{firewall}{Port Scan}

% SIEM log collection
\drawConnection{siem}{firewall}{Logs}
\drawConnection{siem}{ids}{Alerts}
\drawConnection{siem}{webserver}{Logs}
\drawConnection{siem}{router}{NetFlow}

% ===== SECURITY MONITORING (CUSTOMIZE VALUES) =====
\markSecurityControl{firewall}{Firewall}{active}
\markIDS{ids}{IDS/IPS}{12}
\markSIEM{siem}{SIEM Platform}{5000}

\markEDR{workstation}{EDR}{protected}
\cvssBadge{webserver}{7.5}

% ===== DASHBOARDS (CUSTOMIZE METRICS) =====

% IOC Dashboard
\drawIOCDashboard{-16}{8}

% Security status (0-100%)
\drawSecurityStatus{-16}{4}{78}

% Incident tracking (CUSTOMIZE)
\drawIncidentStatus{-16}{0}{INC-YYYY-XXX}{investigating}{High}

% Threat summary
\drawThreatSummary{-16}{-4}

% Risk prioritization (critical, high, medium, low counts)
\drawRiskPriority{12}{8}{1}{3}{8}{15}

% Security metrics (critical, high, incidents_month, mttr_minutes)
\drawSecurityMetrics{12}{4}{1}{3}{5}{25}

% Monitoring coverage (percentage)
\drawMonitoringCoverage{12}{0}{85}

% Defense layers
\drawDefenseLayers{12}{-4}

% ===== TITLE =====
\node[font=\Large\bfseries, text=blue] at (0,11) {SOC Monitoring Dashboard};
\node[font=\small] at (0,10.3) {Last Update: [TIMESTAMP] | Events/sec: XXXX | Alerts: XX};

% Active alerts box (CUSTOMIZE)
\node[draw=orange, fill=orange!10, rounded corners=3pt,
      inner sep=5pt, text width=5cm, font=\tiny, anchor=south west] at (-16,-8) {
    \textbf{ðŸš¨ ACTIVE ALERTS} \\
    \hline \\
    \textcolor{red}{\textbf{HIGH:}} [Alert description] \\
    Time: HH:MM UTC | Action: [Action] \\
    \\
    \textcolor{orange}{\textbf{MEDIUM:}} [Alert description] \\
    Time: HH:MM UTC | Action: [Action] \\
    \\
    \textcolor{blue}{\textbf{INFO:}} [Alert description] \\
    Time: HH:MM UTC
};

\end{tikzpicture}
\end{document}
